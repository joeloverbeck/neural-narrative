<!-- templates/location-hub.html -->
{% extends "base.html" %}

{% block title %}Location Hub{% endblock %}

{% block content %}
<h1>{{ current_place }}</h1>

<div class="place-and-time">
    <div class="current-time">
        Time: {{ current_hour }}:00 {{ current_time_of_day }}
    </div>
</div>

<!-- Describe Place Section -->
<div class="describe-place-section">
    {% if place_description %}
    <div class="place-description-container">
        <p class="place-description">{{ place_description }}</p>
    </div>
    {% endif %}
</div>

<div class="available-actions">
    <h2>Available Actions</h2>
    <div class="action-buttons">
        <form method="post">
            <input name="action" type="hidden" value="Describe Place">
            <input class="action-button" type="submit" value="Describe current place">
        </form>
        {% if current_place_type.value == "location" %}
        <form method="post">
            <input name="action" type="hidden" value="Exit Location">
            <input class="action-button" type="submit" value="Exit current place">
        </form>
        {% endif %}
        <form method="post">
            <input name="action" type="hidden" value="Proceed to Chat">
            <input class="action-button" type="submit" value="Proceed to chat">
        </form>

        <!-- Buttons for visiting locations -->
        {% if locations_present %}
        {% for location in locations_present %}
        <form method="post">
            <input name="action" type="hidden" value="Visit Location">
            <input name="location_identifier" type="hidden" value="{{ location.identifier }}">
            <input class="action-button" type="submit" value="Visit {{ location.place_template }}">
        </form>
        {% endfor %}
        {% endif %}

        <form method="post">
            <input name="action" type="hidden" value="Advance Time">
            <input class="action-button" type="submit" value="Advance time 5 hours">
        </form>
    </div>
</div>

<!-- Form to add characters at the current place to followers -->
{% if characters %}
<h3>Characters at this Location:</h3>
<form method="post">
    <div class="characters-list">
        {% for character in characters %}
        <div class="character card">
            <label>
                <div class="character-content">
                    <input name="add_followers" type="checkbox" value="{{ character.identifier }}">
                    <img alt="{{ character.name }}" src="{{ character.image_url }}" width="150">
                    <div class="character-details">
                        <h2>{{ character.name }}</h2>
                        <p><strong>Description:</strong> {{ character.description }}</p>
                        <p><strong>Equipment:</strong> {{ character.equipment }}</p>
                    </div>
                </div>
            </label>
        </div>
        {% endfor %}
    </div>
    <input name="action" type="submit" value="Add to Followers">
</form>
{% else %}
<p>No characters are present at this location.</p>
{% endif %}

<!-- Form to remove followers and leave them at the current location -->
{% if followers %}
<h3>Your Followers:</h3>
<form method="post">
    <div class="characters-list">
        {% for follower in followers %}
        <div class="character card">
            <label>
                <div class="character-content">
                    <input name="remove_followers" type="checkbox" value="{{ follower.identifier }}">
                    <img alt="{{ follower.name }}" src="{{ follower.image_url }}" width="150">
                    <div class="character-details">
                        <h2>{{ follower.name }}</h2>
                        <p><strong>Description:</strong> {{ follower.description }}</p>
                        <p><strong>Equipment:</strong> {{ follower.equipment }}</p>
                    </div>
                </div>
            </label>
        </div>
        {% endfor %}
    </div>
    <input name="action" type="submit" value="Remove from Followers">
</form>
{% else %}
<p>You have no followers.</p>
{% endif %}

{% endblock %}